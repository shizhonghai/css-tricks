# React-Fiber

## 背景
`React` 在进行组件渲染时，从 `setState` 开始，到渲染完成，整个过程是同步的。
如果需要渲染的组件比较庞大， js 执行会占据主线程时间较长，会导致页面响应度变差，使得 `React` 在动画、手势等应用中效果比较差。

## 实现原理
- 旧版 `React` 通过递归的方式进行渲染，使用的是 JS 引擎自身的函数调用栈，它会一直执行到栈空为止。
- 而 `Fiber` 实现了自己的组件调用栈，它以链表的形式遍历组件树，可以灵活的暂停、继续和丢弃执行的任务。
实现方式是使用了浏览器的 `requestldleCallback` 这一 API。

::: tip Fiber 算法原理
加入 `fiber` 的 `react` 将组建更新分为两个时期：phase1 和 phase2 ，这两个时期以 `render` 为分界，`render`前的生命周期为 phase1，`render` 后的生命周期为 phase2
- phase1 的生命周期是可以被打断的。每个一段时间它会跳出当前渲染进程，去确定是否有其它更重要的任务。
- phase2 的生命周期是不可被打断的。
:::
